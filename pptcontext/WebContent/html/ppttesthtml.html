<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script type="text/javascript" src="jquery-3.3.1.js"></script>
</head>
<body>
<div>
<input type="file" id="file" multiple="multiple">
<br>
<input type="text" id="url" value="">
<table id="filename">

</table>
</div>
<button id="p">确定</button>
<script type="text/javascript">
$(document).ready(function () {
	$("#p").click(function () {
		
		console.log("开始合并数据")
		url="../pptcon"
		var p=[]
		$("#filename").find("tr").each(function(){
			var lp={}
				lp["data"]=$(this).children().eq(0).text()
				lp["url"]=$(this).children().eq(2).text()
				p.push(lp)
		})
			var fileValue=JSON.stringify(p)
		 //生成表单
        var formhtml = $("<form></form>").attr("action", url).attr("method", "post");
     //将数据屯放表单的value
        formhtml.append($("<input></input>").attr("type", "hidden").attr("name", "fileName").attr("value", fileValue));
     //提交表单,并同时移除
        formhtml.appendTo('body').submit().remove();
		
	})
	
	
	$("#file").change(function (e) {
		if ($("#url").val()=="") {
			alert("请输入ppt所在文件夹路径：如：D:/ppt/")
			$("#url").html("")
			$("#url").val(null)
		}else{
		var files=e.target.files
		for (var i = 0; i < files.length; i++) {
			
		
		$("#filename").append(
		           '<tr>'+
		           '<td class="index"></td>'+
		           '<td> .'+e.target.files[i].name+'</td>'+
		           '<td>'+$("#url").val()+e.target.files[i].name+'</td>'+
		           '</tr>'
		
		)
		}
		j=1
		$(".index").each(function(){
			$(this).text(j)
			j++
		})
		}
	})
	
	
	
	
	
	
})







</script>
</body>
</html>